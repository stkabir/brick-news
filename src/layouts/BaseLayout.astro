---
import "../styles/global.css";

interface NavLink {
  slug: string;
  titleEn: string;
  titleEs: string;
}

interface Props {
  navLinks: NavLink[];
  pageTitle?: string;
  descriptionEn?: string;
  descriptionEs?: string;
}

const {
  navLinks,
  pageTitle = "Brickell News",
  descriptionEn = "Your local source for Brickell news.",
  descriptionEs = "Tu fuente local de noticias de Brickell.",
} = Astro.props;

const now = new Date();
const dateEn = now.toLocaleDateString("en-US", {
  weekday: "long",
  year: "numeric",
  month: "long",
  day: "numeric",
});
const dateEs = now.toLocaleDateString("es-ES", {
  weekday: "long",
  year: "numeric",
  month: "long",
  day: "numeric",
});
---
<html lang="en" data-locale="en" class="scroll-smooth">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content={Astro.generator} />
    <title>{pageTitle}</title>
    <meta name="description" content={descriptionEn} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Libre+Franklin:wght@400;500;600;700&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Source+Serif+4:ital,opsz,wght@0,8..60,400;0,8..60,600;0,8..60,700;1,8..60,400&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="bg-paper text-ink">

    <!-- ═══ Dateline Bar ═══ -->
    <div class="border-b border-rule-light">
      <div class="mx-auto max-w-6xl flex items-center justify-between px-6 py-2.5">
        <p class="font-label text-[11px] tracking-[0.15em] uppercase text-ink-faded">
          <span class="lang lang-en">{dateEn}</span>
          <span class="lang lang-es">{dateEs}</span>
          <span class="hidden sm:inline">
            <span class="mx-2 text-rule-light">|</span>
            Miami, Florida
          </span>
        </p>
        <div class="flex items-center gap-4">
          <span class="font-label text-[10px] tracking-[0.2em] uppercase text-ink-faded hidden sm:inline">
            <span class="lang lang-en">Daily Edition</span>
            <span class="lang lang-es">Edición Diaria</span>
          </span>
          <button
            type="button"
            data-lang-toggle
            class="font-label border border-rule px-3 py-1 text-[10px] font-bold uppercase tracking-[0.2em] text-ink transition-colors hover:bg-ink hover:text-paper"
          >
            <span class="lang lang-en">Español</span>
            <span class="lang lang-es">English</span>
          </button>
        </div>
      </div>
    </div>

    <!-- ═══ Masthead ═══ -->
    <header class="mx-auto max-w-6xl px-6 pt-8 pb-2 text-center">
      <div class="border-t border-rule"></div>
      <div class="py-5">
        <h1 class="font-masthead text-5xl sm:text-6xl md:text-8xl tracking-[0.04em] leading-none">
          Brickell News
        </h1>
        <p class="mt-3 font-label text-[11px] tracking-[0.3em] uppercase text-ink-faded">
          <span class="lang lang-en">Miami's Bilingual Neighborhood Journal</span>
          <span class="lang lang-es">El Periódico Bilingüe del Vecindario Brickell</span>
        </p>
      </div>
      <div class="border-t-[3px] border-double border-rule"></div>
    </header>

    <!-- ═══ Navigation ═══ -->
    <nav class="border-b border-rule-light overflow-x-auto">
      <div class="mx-auto max-w-6xl flex items-center justify-center gap-1 px-6 py-3 font-label whitespace-nowrap">
        <a href="#top" class="px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] transition-colors hover:text-accent">
          <span class="lang lang-en">Home</span>
          <span class="lang lang-es">Inicio</span>
        </a>
        {navLinks.map((link) => (
          <>
            <span class="text-rule-light text-[10px] select-none">&#183;</span>
            <a
              href={`#${link.slug}`}
              class="px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] transition-colors hover:text-accent"
            >
              <span class="lang lang-en">{link.titleEn}</span>
              <span class="lang lang-es">{link.titleEs}</span>
            </a>
          </>
        ))}
      </div>
    </nav>

    <!-- ═══ Main Content ═══ -->
    <main id="top" class="mx-auto max-w-6xl px-6 py-8">
      <slot />
    </main>

    <!-- ═══ Footer ═══ -->
    <footer class="border-t-[3px] border-double border-rule">
      <div class="mx-auto max-w-6xl px-6 py-10">
        <div class="border border-rule p-8 text-center">
          <p class="font-label text-[9px] font-bold uppercase tracking-[0.35em] text-ink-faded mb-4">
            <span class="lang lang-en">Newsletter</span>
            <span class="lang lang-es">Boletín</span>
          </p>
          <h2 class="font-headline text-2xl md:text-3xl">
            <span class="lang lang-en">Subscribe to Brickell News</span>
            <span class="lang lang-es">Suscríbete a Brickell News</span>
          </h2>
          <p class="mt-2 text-sm text-ink-light font-article">
            <span class="lang lang-en">Weekly highlights delivered in English and Spanish.</span>
            <span class="lang lang-es">Destacados semanales en inglés y español.</span>
          </p>
          <form class="mt-6 flex flex-col sm:flex-row gap-3 max-w-md mx-auto">
            <label class="sr-only" for="newsletter-email">Email</label>
            <input
              id="newsletter-email"
              type="email"
              placeholder="hello@brickell.news"
              class="font-label flex-1 border border-rule bg-transparent px-4 py-2.5 text-sm focus:outline-none focus:border-accent"
            />
            <button
              type="submit"
              class="font-label bg-ink text-paper px-6 py-2.5 text-[11px] font-bold uppercase tracking-[0.2em] transition-colors hover:bg-accent"
            >
              <span class="lang lang-en">Subscribe</span>
              <span class="lang lang-es">Suscribirse</span>
            </button>
          </form>
        </div>
        <div class="mt-8 border-t border-rule-light pt-6 flex flex-col sm:flex-row items-center justify-between gap-4">
          <p class="font-label text-[10px] uppercase tracking-[0.25em] text-ink-faded">
            <span class="lang lang-en">&copy; {new Date().getFullYear()} Brickell News &mdash; All rights reserved</span>
            <span class="lang lang-es">&copy; {new Date().getFullYear()} Brickell News &mdash; Todos los derechos reservados</span>
          </p>
          <p class="font-label text-[10px] uppercase tracking-[0.25em] text-ink-faded">
            Miami, Florida
          </p>
        </div>
      </div>
    </footer>

    <script is:inline>
      const storageKey = "brickell-news-locale";
      const root = document.documentElement;
      const toggleButton = document.querySelector('[data-lang-toggle]');

      const setLocale = (locale) => {
        if (!['en', 'es'].includes(locale)) locale = 'en';
        root.dataset.locale = locale;
        root.lang = locale;
        toggleButton?.setAttribute('aria-label', locale === 'en' ? 'Switch to Spanish' : 'Cambiar a inglés');
      };

      const saved = typeof window !== 'undefined' ? localStorage.getItem(storageKey) : null;
      if (saved) {
        setLocale(saved);
      }

      toggleButton?.addEventListener('click', () => {
        const next = root.dataset.locale === 'en' ? 'es' : 'en';
        setLocale(next);
        localStorage.setItem(storageKey, next);
      });
    </script>
  </body>
</html>
